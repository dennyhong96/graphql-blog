(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{286:function(e,t,a){e.exports=a.p+"static/media/google.640b004d.png"},327:function(e,t,a){e.exports=a(521)},520:function(e,t,a){},521:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),c=a.n(o),i=a(578),l=a(584),s=a(10),u=a(20),m=(a(332),a(15)),p=a.n(m),d=a(22),b=a(11),f=a(36),g=a(177);g.initializeApp({apiKey:"AIzaSyAFP6uD_kpyFQvcDlTyRVIjXtRlrNir1Dg",authDomain:"nextblog-58070.firebaseapp.com",projectId:"nextblog-58070",storageBucket:"nextblog-58070.appspot.com",appId:"1:440463656920:web:f835cd7749e1970a3c14ad",measurementId:"G-V4CSFJFWTK"});var E=g.auth(),h=new g.auth.GoogleAuthProvider,y={user:null},v=function(e,t){var a=t.type,n=t.payload;switch(a){case"USER_AUTHENTICATED":return Object(f.a)(Object(f.a)({},e),{},{user:n});case"AUTH_ERROR":case"USER_LOGGED_OUT":return y;default:return e}},O=Object(n.createContext)(),j=function(e){var t=e.children,a=Object(n.useReducer)(v,y),o=Object(b.a)(a,2),c=o[0],i=o[1];return Object(n.useEffect)((function(){var e=E.onAuthStateChanged(function(){var e=Object(d.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.next=3,t.getIdTokenResult();case 3:a=e.sent,n=a.token,localStorage.setItem("AUTH_TOKEN",n),i({type:"USER_AUTHENTICATED",payload:{email:t.email,token:n}}),e.next=11;break;case 9:localStorage.removeItem("AUTH_TOKEN"),i({type:"AUTH_ERROR"});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){return e()}}),[]),r.a.createElement(O.Provider,{value:{state:c,dispatch:i}},t)},x=Object(n.createContext)(),w=function(e){var t=e.children,a=Object(n.useState)({show:!1,post:null}),o=Object(b.a)(a,2),c=o[0],i=o[1];return r.a.createElement(x.Provider,{value:{state:c,setState:i}},t)},P=a(30),S=a(19),k=a(581),R=(a(343),a(72)),C=a(100),T=a(567),U=a(593),I=a(588),A=a(585),B=a(86),D=a(559),L=a(562),_=a(561),q=a(563),F=a(564),W=a(592),N=a(129),Q=a(274),H=a(565),z=a(283),M=a.n(z),$=a(282),G=a.n($),K=a(284),Y=a.n(K),J=a(28);function V(){var e=Object(J.a)(["\n  fragment postInfo on Post {\n    _id\n    title\n    content\n    tags\n    image {\n      url\n      key\n    }\n    postedBy {\n      _id\n      username\n      name\n      email\n      images {\n        url\n        key\n      }\n      about\n      createdAt\n      updatedAt\n    }\n    createdAt\n    updatedAt\n  }\n"]);return V=function(){return e},e}var Z=Object(s.gql)(V());function X(){var e=Object(J.a)(["\n  mutation UpdatePost($input: UpdatePostInput!) {\n    updatePost(input: $input) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return X=function(){return e},e}function ee(){var e=Object(J.a)(["\n  mutation DeletePost($id: ID!) {\n    deletePost(id: $id) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return ee=function(){return e},e}function te(){var e=Object(J.a)(["\n  mutation CreatePost($input: CreatePostInput!) {\n    createPost(input: $input) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return te=function(){return e},e}var ae=Object(s.gql)(te(),Z),ne=Object(s.gql)(ee(),Z),re=Object(s.gql)(X(),Z);function oe(){var e=Object(J.a)(["\n  query SearchPosts($term: String!) {\n    searchPosts(term: $term) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return oe=function(){return e},e}function ce(){var e=Object(J.a)(["\n  query CountPosts {\n    countPosts\n  }\n"]);return ce=function(){return e},e}function ie(){var e=Object(J.a)(["\n  query GetPost($id: ID!) {\n    getPost(id: $id) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return ie=function(){return e},e}function le(){var e=Object(J.a)(["\n  query ListPostsByUser($username: String!) {\n    listPostsByUser(username: $username) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return le=function(){return e},e}function se(){var e=Object(J.a)(["\n  query ListPosts($numPage: Int, $numLimit: Int) {\n    listPosts(numPage: $numPage, numLimit: $numLimit) {\n      ...postInfo\n    }\n  }\n  ","\n"]);return se=function(){return e},e}var ue=Object(s.gql)(se(),Z),me=Object(s.gql)(le(),Z),pe=Object(s.gql)(ie(),Z),de=Object(s.gql)(ce()),be=Object(s.gql)(oe(),Z),fe=function(e){var t=e.post,a=Object(n.useContext)(O).state.user,o=Object(n.useContext)(x).setState,c=Object(s.useMutation)(ne,{update:function(e,t){var a=t.data.deletePost;try{var n=e.readQuery({query:ue}).listPosts;e.writeQuery({query:ue,data:{listPosts:n.filter((function(e){return e._id!==a._id}))}})}catch(o){console.error("[CERATE POST UPDATE CACHE FAILED - ListPosts QUERY]")}try{var r=e.readQuery({query:me,variables:{username:a.postedBy.username}}).listPostsByUser;e.writeQuery({query:me,variables:{username:a.postedBy.username},data:{listPostsByUser:r.filter((function(e){return e._id!==a._id}))}})}catch(o){console.error("[CERATE POST UPDATE CACHE FAILED - ListPostsByUser QUERY]")}}}),i=Object(b.a)(c,1)[0],l=function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i({variables:{id:t._id}});case 3:S.b.success("Post ".concat(t.title," successfully deleted.")),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("[DELETE POST ERROR]",e.t0),S.b.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(D.a,{elevation:4},r.a.createElement(_.a,{avatar:r.a.createElement(W.a,{src:t.postedBy.images[0].url}),title:"@".concat(t.postedBy.username),subheader:Object(A.a)(new Date(t.createdAt),new Date,{addSuffix:!0})}),r.a.createElement(L.a,{component:u.b,to:"/posts/".concat(t._id)},r.a.createElement(B.a,{src:t.image.url,title:t.title,height:200,transition:500,style:{width:"100%",height:200,objectFit:"cover"}}),r.a.createElement(q.a,null,r.a.createElement(N.a,{gutterBottom:!0,noWrap:!0,style:{fontWeight:500,fontSize:"1.1rem"}},t.title),t.tags.map((function(e,t){return r.a.createElement(Q.a,{key:"".concat(e,"-idx"),label:e,color:"secondary",size:"small",style:{marginRight:3}})})))),r.a.createElement(F.a,{disableSpacing:!0,style:{display:"flex"}},r.a.createElement("div",{style:{marginLeft:"auto"}},a&&t.postedBy.email===a.email&&r.a.createElement(n.Fragment,null,r.a.createElement(H.a,{onClick:l},r.a.createElement(G.a,null)),r.a.createElement(H.a,{onClick:function(){return o({post:t})}},r.a.createElement(M.a,null))),r.a.createElement(H.a,{component:u.b,to:"/posts/".concat(t._id)},r.a.createElement(Y.a,null)))))},ge=a(566),Ee=function(){return r.a.createElement(D.a,{elevation:4},r.a.createElement(_.a,{avatar:r.a.createElement(ge.a,{variant:"circle",width:50,height:50}),title:r.a.createElement(ge.a,{variant:"rect",width:"30%",style:{marginBottom:5}}),subheader:r.a.createElement(ge.a,{variant:"rect",width:"40%"})}),r.a.createElement(ge.a,{variant:"rect",style:{height:200,width:"100%"}}),r.a.createElement(q.a,null,r.a.createElement(ge.a,{variant:"rect",width:"100%",style:{marginBottom:5}}),r.a.createElement(ge.a,{variant:"rect",width:"75%",style:{marginBottom:10}}),r.a.createElement(ge.a,{variant:"rect",width:"20%",style:{borderRadius:"5rem",display:"inline-block",marginRight:3,height:20}}),r.a.createElement(ge.a,{variant:"rect",width:"20%",style:{borderRadius:"5rem",display:"inline-block",marginRight:3,height:20}}),r.a.createElement(ge.a,{variant:"rect",width:"20%",style:{borderRadius:"5rem",display:"inline-block",marginRight:3,height:20}})),r.a.createElement(F.a,{disableSpacing:!0,style:{display:"flex"}},r.a.createElement(ge.a,{variant:"rect",width:"25%",style:{marginLeft:"auto",height:30}})))};function he(){var e=Object(J.a)(["\n  subscription onPostDeleted {\n    onPostDeleted {\n      ...postInfo\n    }\n  }\n  ","\n"]);return he=function(){return e},e}function ye(){var e=Object(J.a)(["\n  subscription onPostUpdated {\n    onPostUpdated {\n      ...postInfo\n    }\n  }\n  ","\n"]);return ye=function(){return e},e}function ve(){var e=Object(J.a)(["\n  subscription OnPostCreated {\n    onPostCreated {\n      ...postInfo\n    }\n  }\n  ","\n"]);return ve=function(){return e},e}var Oe=Object(s.gql)(ve(),Z),je=Object(s.gql)(ye(),Z),xe=Object(s.gql)(he(),Z),we={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.15}},exit:{opacity:0,transition:{duration:.15}}},Pe={hidden:{opacity:0,y:-50},visible:{opacity:1,y:-0},exit:{opacity:0,y:-50}},Se=function(){var e=Object(n.useState)(!0),t=Object(b.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)([]),i=Object(b.a)(c,2),l=i[0],u=i[1],m=Object(n.useState)(1),p=Object(b.a)(m,2),d=p[0],g=p[1];Object(s.useSubscription)(Oe,{onSubscriptionData:function(e){var t=e.client,a=e.subscriptionData,n=t.cache.readQuery({query:ue}).listPosts;t.cache.writeQuery({query:ue,data:{listPosts:[].concat(Object(R.a)(n),[a.data.onPostCreated])}})}}),Object(s.useSubscription)(je),Object(s.useSubscription)(xe,{onSubscriptionData:function(e){var t=e.client,a=e.subscriptionData,n=t.cache.readQuery({query:ue}).listPosts;t.cache.writeQuery({query:ue,data:{listPosts:n.filter((function(e){return e._id!==a.data.onPostDeleted._id}))}})}});var E=Object(s.useQuery)(de,{pollInterval:1e4}).data,h=Object(s.useQuery)(ue,{fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!1,onCompleted:function(e){u(e.listPosts),o(!1)}}),y=h.fetchMore,v=h.error,O=h.loading;return v?r.a.createElement("p",null,v.message):r.a.createElement(n.Fragment,null,r.a.createElement(T.a,{container:!0,direction:"column",style:{minHeight:"calc(100vh - 64px - 2rem)"}},r.a.createElement(T.a,{item:!0},r.a.createElement(C.a,null,r.a.createElement(T.a,{container:!0,spacing:4},a&&O&&Array.from({length:6}).map((function(e,t){return r.a.createElement(T.a,{item:!0,key:t,xs:12,sm:6,md:4},r.a.createElement(C.b.div,{variants:we,initial:"hidden",animate:"visible",exit:"exit"},r.a.createElement(Ee,null)))})),!v&&l.slice(6*(d-1),6*(d-1)+6).map((function(e){return r.a.createElement(T.a,{item:!0,xs:12,sm:6,md:4,key:e._id},r.a.createElement(C.b.div,{variants:Pe,initial:"hidden",animate:"visible",exit:"exit"},r.a.createElement(fe,{post:e})))}))))),r.a.createElement(T.a,{item:!0,style:{marginTop:"auto",marginBottom:"1rem"}},r.a.createElement(U.a,{style:{display:"flex",marginTop:"1rem"}},E&&r.a.createElement(I.a,{color:"primary",style:{margin:"0 auto"},count:Math.ceil(E.countPosts/6),page:d,onChange:function(e,t){t!==d&&(g(t),y({variables:{numPage:t,numLimit:6},updateQuery:function(e,t){var a=t.fetchMoreResult;if(!a)return e;var n=a.listPosts.filter((function(t){return!e.listPosts.find((function(e){return e._id===t._id}))}));return Object(f.a)(Object(f.a)({},e),{},{listPosts:[].concat(Object(R.a)(e.listPosts),Object(R.a)(n))})}}))}})))))},ke=a(587),Re=a(571),Ce=a(572),Te=function(){var e=Object(n.useState)(""),t=Object(b.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),i=Object(b.a)(c,2),l=i[0],s=i[1],m=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s(!0),e.prev=2,e.next=5,E.sendSignInLinkToEmail(a,{url:"http://localhost:3000/complete-register",handleCodeInApp:!0});case 5:localStorage.setItem("REGISTER_EMAIL",a),S.b.success("Link successfully sent to ".concat(a,", click the link to complete your registration.")),o(""),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0);case 13:s(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(T.a,{container:!0},r.a.createElement(T.a,{item:!0,xs:!0}),r.a.createElement(T.a,{item:!0,xs:!0},r.a.createElement(D.a,{style:{padding:"1rem"},elevation:3},r.a.createElement(q.a,null,r.a.createElement(N.a,{variant:"h6",align:"center",gutterBottom:!0},"Register Account"),r.a.createElement(U.a,{component:"form",onSubmit:m},r.a.createElement(ke.a,{id:"register-email",label:"Enter your email address",fullWidth:!0,value:a,onChange:function(e){return o(e.target.value)},style:{marginBottom:"1rem"},inputProps:{type:"email"}}),r.a.createElement(Re.a,{color:"primary",variant:"contained",disabled:!a||!!l,fullWidth:!0,type:"submit"},l?r.a.createElement(Ce.a,{style:{height:"1.5rem",width:"1.5rem"}}):"Register")),r.a.createElement(N.a,{variant:"caption",style:{display:"block",marginTop:"0.5rem"}},"Has an account? ",r.a.createElement(u.b,{to:"/login"},"Sign in.")),r.a.createElement(N.a,{variant:"caption",color:"textPrimary"},"Forgot password?"," ",r.a.createElement(u.b,{to:"/password-forget"},"Reset password."))))),r.a.createElement(T.a,{item:!0,xs:!0}))};function Ue(){var e=Object(J.a)(["\n  fragment userInfo on User {\n    _id\n    username\n    name\n    email\n    images {\n      url\n      key\n    }\n    about\n    createdAt\n    updatedAt\n  }\n"]);return Ue=function(){return e},e}var Ie=Object(s.gql)(Ue());function Ae(){var e=Object(J.a)(["\n  mutation CreateUser {\n    createUser {\n      username\n      email\n    }\n  }\n"]);return Ae=function(){return e},e}function Be(){var e=Object(J.a)(["\n  mutation UpdateUser($input: UpdateUserInput!) {\n    updateUser(input: $input) {\n      ...userInfo\n    }\n  }\n  ","\n"]);return Be=function(){return e},e}var De=Object(s.gql)(Be(),Ie),Le=Object(s.gql)(Ae()),_e=function(){var e=Object(P.g)(),t=Object(s.useMutation)(Le),a=Object(b.a)(t,1)[0],o=Object(n.useContext)(O).dispatch,c=Object(n.useState)(localStorage.getItem("REGISTER_EMAIL")||""),i=Object(b.a)(c,1)[0],l=Object(n.useState)(""),u=Object(b.a)(l,2),m=u[0],f=u[1],g=Object(n.useState)(null),h=Object(b.a)(g,2),y=h[0],v=h[1],j=Object(n.useState)(!1),x=Object(b.a)(j,2),w=x[0],k=x[1];Object(n.useEffect)((function(){v(window.location.href),window.history.pushState({},"","/complete-register")}),[]);var R=function(){var t=Object(d.a)(p.a.mark((function t(n){var r,c,l,s,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),i&&m||S.b.error("Email and password are required."),k(!0),t.prev=3,t.next=6,E.signInWithEmailLink(i,y);case 6:if(c=t.sent,!(null===(r=c.user)||void 0===r?void 0:r.emailVerified)){t.next=24;break}return localStorage.removeItem("REGISTER_EMAIL"),l=E.currentUser,console.log({user:l}),t.next=13,l.updatePassword(m);case 13:return t.next=15,l.getIdTokenResult();case 15:return s=t.sent,u=s.token,localStorage.setItem("AUTH_TOKEN",u),o({type:"USER_AUTHENTICATED",payload:{email:l.email,token:u}}),t.next=21,a();case 21:return S.b.success("Your registration was successful!"),k(!1),t.abrupt("return",e.push("/dashboard/profile"));case 24:throw new Error("Unable to verify your email, try again later.");case 27:t.prev=27,t.t0=t.catch(3),console.error(t.t0),S.b.error(t.t0.message),k(!1);case 32:case"end":return t.stop()}}),t,null,[[3,27]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(T.a,{container:!0},r.a.createElement(T.a,{item:!0,xs:!0}),r.a.createElement(T.a,{item:!0,xs:!0},r.a.createElement(D.a,{style:{padding:"1rem"}},r.a.createElement(q.a,null,r.a.createElement(U.a,{component:"form",onSubmit:R},r.a.createElement(N.a,{variant:"h6",align:"center",gutterBottom:!0},"Set a password"),r.a.createElement(ke.a,{id:"complete-email",label:"Enter your email address",fullWidth:!0,value:i,style:{marginBottom:"1rem"},inputProps:{type:"email"},disabled:!0}),r.a.createElement(ke.a,{id:"complete-password",label:"Enter a password",fullWidth:!0,value:m,onChange:function(e){return f(e.target.value)},style:{marginBottom:"1rem"},inputProps:{type:"password"}}),r.a.createElement(Re.a,{color:"primary",variant:"contained",disabled:!m||!!w,fullWidth:!0,type:"submit"},w?r.a.createElement(Ce.a,{style:{height:"1.5rem",width:"1.5rem"}}):"Complete Registeration"))))),r.a.createElement(T.a,{item:!0,xs:!0}))},qe=a(286),Fe=a.n(qe),We=function(){var e=Object(P.g)(),t=Object(s.useMutation)(Le),a=Object(b.a)(t,1)[0],o=Object(n.useContext)(O).dispatch,c=Object(n.useState)(""),i=Object(b.a)(c,2),l=i[0],m=i[1],f=Object(n.useState)(""),g=Object(b.a)(f,2),y=g[0],v=g[1],j=Object(n.useState)(!1),x=Object(b.a)(j,2),w=x[0],k=x[1],R=function(){var e=Object(d.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),l&&y){e.next=3;break}return e.abrupt("return",S.b.error("Email and password are required."));case 3:return k(!0),e.prev=4,e.next=7,E.signInWithEmailAndPassword(l,y);case 7:return a=e.sent,n=a.user,e.next=11,I(n);case 11:e.next=18;break;case 13:e.prev=13,e.t0=e.catch(4),console.error(e.t0),S.b.error(e.t0.message),k(!1);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(d.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.prev=1,e.next=4,E.signInWithPopup(h);case 4:return t=e.sent,a=t.user,e.next=8,I(a);case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0),S.b.error(e.t0.message),k(!1);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var t=Object(d.a)(p.a.mark((function t(n){var r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getIdTokenResult();case 2:return r=t.sent,c=r.token,localStorage.setItem("AUTH_TOKEN",c),o({type:"USER_AUTHENTICATED",payload:{email:n.email,token:c}}),t.next=8,a();case 8:S.b.success("Sign in success."),k(!1),e.push("/dashboard/profile");case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(T.a,{container:!0},r.a.createElement(T.a,{item:!0,xs:!0}),r.a.createElement(T.a,{item:!0,xs:!0},r.a.createElement(D.a,{style:{padding:"1rem"},elevation:3},r.a.createElement(q.a,null,r.a.createElement(U.a,{component:"form",onSubmit:R},r.a.createElement(N.a,{variant:"h6",align:"center",gutterBottom:!0},"Log in"),r.a.createElement(ke.a,{id:"complete-email",label:"Enter your email address",fullWidth:!0,value:l,onChange:function(e){return m(e.target.value)},style:{marginBottom:"1rem"},inputProps:{type:"email"},disabled:w}),r.a.createElement(ke.a,{id:"complete-password",label:"Enter a password",fullWidth:!0,value:y,onChange:function(e){return v(e.target.value)},style:{marginBottom:"1rem"},inputProps:{type:"password"},disabled:w}),r.a.createElement(Re.a,{color:"primary",variant:"contained",disabled:!y||!!w,fullWidth:!0,type:"submit"},w?r.a.createElement(Ce.a,{style:{height:"1.5rem",width:"1.5rem"}}):"Log in"),r.a.createElement(H.a,{onClick:C,style:{marginTop:"0.5rem",padding:"0.25rem"}},r.a.createElement("img",{src:Fe.a,alt:"Sign in with google",width:30}))),r.a.createElement(N.a,{variant:"caption",style:{display:"block",marginTop:"0.5rem"}},"Don't own an account? ",r.a.createElement(u.b,{to:"/register"},"Sign up.")),r.a.createElement(N.a,{variant:"caption",color:"textPrimary"},"Forgot password?"," ",r.a.createElement(u.b,{to:"/password-forget"},"Reset password."))))),r.a.createElement(T.a,{item:!0,xs:!0}))},Ne=function(){var e=Object(n.useState)(""),t=Object(b.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),i=Object(b.a)(c,2),l=i[0],s=i[1],u=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s(!0),e.prev=2,e.next=5,E.sendPasswordResetEmail(a,{url:"http://localhost:3000/login",handleCodeInApp:!0});case 5:o(""),S.b.success("Reset password email successfully sent."),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("[FORGET PASSWORD ERROR]",e.t0),S.b.error(e.t0.message);case 13:s(!1);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(T.a,{container:!0},r.a.createElement(T.a,{item:!0,xs:!0}),r.a.createElement(T.a,{item:!0,xs:!0},r.a.createElement(D.a,{style:{padding:"1rem"},elevation:3},r.a.createElement(q.a,null,r.a.createElement(N.a,{variant:"h6",align:"center",gutterBottom:!0},"Forget Password"),r.a.createElement(U.a,{component:"form",onSubmit:u},r.a.createElement(ke.a,{id:"register-email",label:"Enter your email address",fullWidth:!0,value:a,onChange:function(e){return o(e.target.value)},style:{marginBottom:"1rem"},inputProps:{type:"email"}}),r.a.createElement(Re.a,{color:"primary",variant:"contained",disabled:!a||!!l,fullWidth:!0,type:"submit"},l?r.a.createElement(Ce.a,{style:{height:"1.5rem",width:"1.5rem"}}):"Send password reset email"))))),r.a.createElement(T.a,{item:!0,xs:!0}))},Qe=a(577),He=a(586),ze=a(579),Me=a(162);function $e(){var e=Object(J.a)(["\n  query GetPublicProfile($username: String!) {\n    getPublicProfile(username: $username) {\n      ...userInfo\n    }\n  }\n  ","\n"]);return $e=function(){return e},e}function Ge(){var e=Object(J.a)(["\n  query ListUsers {\n    listUsers {\n      ...userInfo\n    }\n  }\n  ","\n"]);return Ge=function(){return e},e}function Ke(){var e=Object(J.a)(["\n  query GetUser {\n    getUser {\n      ...userInfo\n    }\n  }\n  ","\n"]);return Ke=function(){return e},e}var Ye,Je=Object(s.gql)(Ke(),Ie),Ve=Object(s.gql)(Ge(),Ie),Ze=Object(s.gql)($e(),Ie),Xe=a(112),et=a.n(Xe),tt=a(287),at=a.n(tt),nt=function(e){return new Promise((function(t){at.a.imageFileResizer(e,600,600,"JPEG",100,0,(function(e){t(e)}),"base64")}))},rt=function(){var e=Object(d.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.map((function(e){return nt(e)})),e.next=3,Promise.all(a);case 3:return n=e.sent,e.next=6,et.a.post("".concat("http://localhost:8000","/api/v1/images/profiles"),{images:n},{headers:{authorization:"Bearer ".concat(localStorage.getItem("AUTH_TOKEN"))}});case 6:return r=e.sent,e.abrupt("return",r.data.data.images);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,et.a.delete("".concat("http://localhost:8000","/api/v1/images/profiles"),{headers:{authorization:"Bearer ".concat(localStorage.getItem("AUTH_TOKEN"))},params:{imageKey:t.key}});case 2:return a=e.sent,e.abrupt("return",a.data.data.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=et.a,e.t1="".concat("http://localhost:8000","/api/v1/images/posts"),e.next=4,nt(t);case 4:return e.t2=e.sent,e.t3={image:e.t2},e.t4={headers:{authorization:"Bearer ".concat(localStorage.getItem("AUTH_TOKEN"))}},e.next=9,e.t0.post.call(e.t0,e.t1,e.t3,e.t4);case 9:return a=e.sent,e.abrupt("return",a.data.data.image);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=function(e){var t=Object(n.useState)(!0),a=Object(b.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)((function(){o(!1),setTimeout((function(){o(!0)}),1)}),[e.length]),{showDropZone:r}},lt=a(175),st=function(e){var t=e.showDropZone,a=e.images,n=e.handleFiles;return t?r.a.createElement(lt.a,{acceptedFiles:["image/*"],dropzoneText:a.length>=5?"You already have 5 profile images, delete some to add new ones.":"You have ".concat(a.length," profile images, you can upload ").concat(5-a.length," more."),onChange:n,inputProps:{disabled:a.length>=5},filesLimit:5-a.length,clearOnUnmount:!0}):r.a.createElement("div",{className:"MuiDropzoneArea-root"})},ut=a(173),mt=a.n(ut),pt=function(e){var t=e.images,a=e.handleDelete,n=dt();return r.a.createElement(U.a,{className:n.images},t.map((function(e){return r.a.createElement(U.a,{key:e.url,className:n.image},a&&e.key&&r.a.createElement(H.a,{className:n.deleteBtn,onClick:function(){return a(e)}},r.a.createElement(mt.a,{className:n.deleteIcon})),r.a.createElement(B.a,{height:150,width:150,src:e.url,alt:"User profile",style:{boxShadow:"0 3px 7px rgb(0,0,0,0.1)",borderRadius:3,objectFit:"cover",height:150,width:150}}))})))},dt=Object(Qe.a)((function(){return{images:{marginBottom:"1rem",display:"flex",flexWrap:"wrap"},image:{position:"relative",marginRight:"1.25rem","&:hover":{"& .MuiIconButton-root":{opacity:1,transition:"all 0.2s ease"}}},deleteBtn:{opacity:0,transition:"all 0.2s ease",position:"absolute",right:4,top:2,backgroundColor:"#e0e0e0",padding:"0.25rem",boxShadow:"0 3px 7px rgb(0,0,0,0.075)","&:hover":{backgroundColor:"#eeeeee"}},deleteIcon:{width:20,height:20}}})),bt=function(e){var t=e.email,a=e.username,o=e.name,c=e.about,i=e.loading,l=e.handleChange;return r.a.createElement(n.Fragment,null,r.a.createElement(ke.a,{id:"profile-update-email",label:"Your email.",fullWidth:!0,name:"email",value:t,style:{marginBottom:"1rem"},disabled:!0}),r.a.createElement(ke.a,{id:"profile-update-username",label:"Enter a new username.",fullWidth:!0,name:"username",value:a,onChange:l,style:{marginBottom:"1rem"},disabled:i}),r.a.createElement(ke.a,{id:"profile-update-name",label:"Enter a new name.",fullWidth:!0,name:"name",value:o,onChange:l,style:{marginBottom:"1rem"},disabled:i}),r.a.createElement(ke.a,{id:"profile-update-about",label:"Write something about your self.",fullWidth:!0,name:"about",value:c,onChange:l,style:{marginBottom:"1rem"},disabled:i,multiline:!0}))},ft={username:"",name:"",email:"",about:"",images:[]},gt=function(){var e=Object(n.useState)([]),t=Object(b.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),i=Object(b.a)(c,2),l=i[0],u=i[1],m=Object(n.useState)(ft),g=Object(b.a)(m,2),E=g[0],h=g[1],y=E.username,v=E.name,O=E.about,j=E.images,x=Object(s.useQuery)(Je).data,w=Object(s.useMutation)(De,{variables:{input:{username:y,name:v,about:O,images:j}}}),P=Object(b.a)(w,1)[0];Object(n.useMemo)((function(){(null===x||void 0===x?void 0:x.getUser)&&h(x.getUser)}),[x]);var k=it(j).showDropZone,C=function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),u(!0),e.prev=2,!a.length){e.next=8;break}return e.next=6,rt(a);case 6:n=e.sent,h((function(e){return Object(f.a)(Object(f.a)({},e),{},{images:[].concat(Object(R.a)(e.images),Object(R.a)(n))})}));case 8:return e.next=10,P();case 10:r=e.sent,h(r.data.updateUser),S.b.success("Profile successfully updated."),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.error("PROFILE UPDATE ERROR",e.t0),S.b.error(e.t0.message||e.t0.response.data.message);case 19:u(!1);case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,ot(t);case 4:a=e.sent,h((function(e){return Object(f.a)(Object(f.a)({},e),{},{images:e.images.filter((function(e){return e.key!==t.key}))})})),o([]),S.b.success(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("PROFILE UPDATE ERROR",e.t0),S.b.error(e.t0.response.data.message);case 14:u(!1);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(U.a,{component:"form",style:{marginBottom:"1rem"},onSubmit:C},r.a.createElement(N.a,{variant:"h6",style:{marginBottom:"0.5rem"}},"Update your profile:"),r.a.createElement(bt,Object.assign({},E,{loading:l,handleChange:function(e){var t=e.target,a=t.name,n=t.value;h((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(Me.a)({},a,n))}))}})),r.a.createElement(pt,{images:j,handleDelete:T}),r.a.createElement(st,{images:j,showDropZone:k,handleFiles:o}),r.a.createElement(Re.a,{variant:"contained",type:"submit",color:"primary",disabled:l},l?r.a.createElement(Ce.a,{size:24}):"Update"))},Et=a(594),ht=a(576),yt=a(575),vt=a(574),Ot=function(e){var t=e.children,a=e.title,n=e.open,o=e.handleClose,c=e.confirmButtonText,i=e.handleConfirm,l=e.loading,s=e.disabled;return r.a.createElement(Et.a,{open:n,onClose:o,maxWidth:"sm",fullWidth:!0},r.a.createElement(vt.a,null,a),r.a.createElement(yt.a,null,t),r.a.createElement(ht.a,null,r.a.createElement(Re.a,{onClick:o,color:"primary",disabled:l},"Cancel"),r.a.createElement(Re.a,{onClick:i,color:"primary",variant:"contained",autoFocus:!0,disabled:s&&s||l},l?r.a.createElement(Ce.a,{size:24}):c)))},jt=function(){var e=Object(n.useState)(!1),t=Object(b.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),i=Object(b.a)(c,2),l=i[0],s=i[1],u=Object(n.useState)(""),m=Object(b.a)(u,2),f=m[0],g=m[1],h=Object(n.useState)(!1),y=Object(b.a)(h,2),v=y[0],O=y[1],j=function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l===f){e.next=2;break}return e.abrupt("return",S.b.error("Passwords do not match."));case 2:return O(!0),e.prev=3,O(!1),e.next=7,E.currentUser.updatePassword(l);case 7:S.b.success("Password successfully reset."),s(""),g(""),o(!1),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(3),console.error("[RESET PASSWORD ERROR]",e.t0),S.b.error(e.t0.message),O(!1);case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,r.a.createElement(Re.a,{variant:"contained",color:"primary",onClick:o.bind(void 0,!0)},"Reset Password"),r.a.createElement(Ot,{title:"Reset your password",open:a,handleClose:o.bind(void 0,!1),confirmButtonText:"Reset",loading:v,handleConfirm:j,disabled:!(l&&f)},r.a.createElement(ke.a,{id:"reset-password",label:"Enter your new password",fullWidth:!0,value:l,onChange:function(e){return s(e.target.value)},style:{marginBottom:"0.25rem"},inputProps:{type:"password"},disabled:v}),r.a.createElement(ke.a,{id:"reset-password-confirm",label:"Confirm your new password",fullWidth:!0,value:f,onChange:function(e){return g(e.target.value)},style:{marginBottom:"1rem"},inputProps:{type:"password"},disabled:v})))},xt=function(){var e=Object(n.useContext)(O).state.user;return r.a.createElement(n.Fragment,null,r.a.createElement(N.a,{variant:"h4",component:"h1",style:{marginBottom:"1rem",fontWeight:"500"}},"Welcome back, ",null===e||void 0===e?void 0:e.email.split("@")[0],"!"),r.a.createElement(gt,null),r.a.createElement(jt,null))},wt=a(174),Pt=a.n(wt),St=a(297),kt=a.n(St),Rt=a(296),Ct=a.n(Rt),Tt=(a(500),function(e){var t=e.content,a=e.setContent;return r.a.createElement(Ct.a,{value:t,onChange:a})}),Ut=function(e){var t=e.image,a=e.handleFiles,n=e.isUpdate,o=void 0!==n&&n;return r.a.createElement(lt.a,{acceptedFiles:["image/*"],dropzoneText:t?t.name:o?"Update Image":"Attach an image for your post",onChange:a,inputProps:{disabled:!1},filesLimit:1,clearOnUnmount:!0})},It=function(){var e=Object(n.useState)(""),t=Object(b.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(null),i=Object(b.a)(c,2),l=i[0],u=i[1],m=Object(n.useState)(""),f=Object(b.a)(m,2),g=f[0],E=f[1],h=Object(n.useState)(!1),y=Object(b.a)(h,2),v=y[0],O=y[1],j=Object(n.useState)([]),x=Object(b.a)(j,2),w=x[0],P=x[1],k=Object(n.useState)(!0),C=Object(b.a)(k,2),I=C[0],A=C[1],B=Object(s.useMutation)(ae,{update:function(e,t){var a=t.data.createPost;try{var n=e.readQuery({query:me,variables:{username:a.postedBy.username}}).listPostsByUser;e.writeQuery({query:me,data:{listPostsByUser:[a].concat(Object(R.a)(n))},variables:{username:a.postedBy.username}})}catch(o){console.error("[CERATE POST UPDATE CACHE FAILED - ListPostsByUser QUERY]")}try{var r=e.readQuery({query:ue}).listPosts;e.writeQuery({query:ue,data:{listPosts:[a].concat(Object(R.a)(r))}})}catch(o){console.error("[CERATE POST UPDATE CACHE FAILED - ListPosts QUERY]")}}}),D=Object(b.a)(B,1)[0],L=function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),O(!0),e.prev=2,a&&g){e.next=5;break}return e.abrupt("return",S.b.error("Title and content are required."));case 5:if(!l){e.next=9;break}return e.next=8,ct(l);case 8:n=e.sent;case 9:return e.next=11,D({variables:{input:{title:a,content:g,tags:w,image:n}}});case 11:r=e.sent,S.b.success('Post "'.concat(r.data.createPost.title,'" has been successfully publishsed.')),o(""),E(""),P([]),u(null),A(!1),setTimeout((function(){A(!0)}),0),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),console.error("[CREATE POST ERROR]",e.t0),S.b.error(e.t0.message);case 25:O(!1);case 26:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(U.a,{component:"form",onSubmit:L},r.a.createElement(T.a,{container:!0,justify:"space-between"},r.a.createElement(T.a,{item:!0},r.a.createElement(N.a,{variant:"h4",component:"h1",style:{marginBottom:"1rem",fontWeight:"500"}},"Create a post!")),r.a.createElement(T.a,{item:!0},r.a.createElement(Re.a,{disabled:v||!(a&&g),type:"submit",variant:"contained",color:"primary"},v?r.a.createElement(Ce.a,{size:24}):r.a.createElement(n.Fragment,null,r.a.createElement(kt.a,{style:{marginRight:3,fontSize:20}})," ",r.a.createElement("span",{style:{marginTop:5}},"Post"))))),r.a.createElement(ke.a,{id:"create-post-title",label:"Give your post a title",fullWidth:!0,value:a,onChange:function(e){return o(e.target.value)},inputProps:{type:"text"},style:{marginBottom:"1rem"},disabled:v}),r.a.createElement(Pt.a,{value:w,fullWidth:!0,label:"Add post tags",placeholder:"Type and press enter to add tags",style:{marginBottom:"1rem"},onChange:P}),I&&r.a.createElement(Ut,{image:l,handleFiles:function(e){return u(e.length?e[0]:null)}}),r.a.createElement(Tt,{content:g,setContent:E}))},At=a(176),Bt=a(178),Dt=a.n(Bt),Lt=function(){return Object(n.useState)(Dt.a.start()),Object(n.useEffect)((function(){return Dt.a.done(),function(){return Dt.a.start()}})),null},_t=function(e){var t=e.component,a=Object(At.a)(e,["component"]),o=Object(n.useContext)(O).state.user;return Lt(),o||localStorage.getItem("AUTH_TOKEN")?r.a.createElement(P.b,Object.assign({},a,{component:t})):r.a.createElement(P.a,{to:"/"})},qt=a(573),Ft=[{pathname:"/dashboard/profile",label:"Dashboard",component:xt},{pathname:"/dashboard/create",label:"Create Post",component:It},{pathname:"/dashboard/posts",label:"My Posts",component:function(){var e=Object(s.useQuery)(Je).data,t=Object(s.useLazyQuery)(me),a=Object(b.a)(t,2),o=a[0],c=a[1],i=c.data,l=c.loading,u=c.error;return Object(n.useEffect)((function(){e&&e.getUser&&o({variables:{username:e.getUser.username}})}),[e,o]),r.a.createElement(T.a,{container:!0,spacing:4},l&&Array.from({length:8}).map((function(e,t){return r.a.createElement(qt.a,{in:l,timeout:250,key:t},r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(Ee,null)))})),!l&&!u&&i&&i.listPostsByUser.map((function(e){return r.a.createElement(qt.a,{in:!l&&!u&&!!i,timeout:750,key:e._id},r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(fe,{post:e})))})))}}],Wt=Object(Qe.a)((function(e){return{tabs:{borderRight:"1px solid ".concat(e.palette.divider)}}})),Nt=function(){var e=Wt(),t=Object(P.h)();return r.a.createElement(T.a,{container:!0,spacing:2},r.a.createElement(T.a,{item:!0,xs:12,sm:4,md:3},r.a.createElement(He.a,{orientation:"vertical",variant:"scrollable",className:e.tabs,value:Ft.findIndex((function(e){return e.pathname===t.pathname}))},Ft.map((function(e){return r.a.createElement(ze.a,{key:e.pathname,component:u.b,to:e.pathname,label:e.label})})))),r.a.createElement(T.a,{item:!0,xs:12,sm:8,md:9},r.a.createElement(P.d,null,Ft.map((function(e){return r.a.createElement(_t,{key:e.pathname,exact:!0,path:e.pathname,component:e.component})})))))},Qt=a(590),Ht=function(){var e=Object(P.i)().username,t=Object(s.useQuery)(Ze,{variables:{username:e}}),a=t.data,o=t.loading,c=t.error,i=Object(s.useQuery)(me,{variables:{username:e}}),l=i.data,u=i.loading,m=i.error;return!o&&!c&&a&&r.a.createElement(n.Fragment,null,r.a.createElement(T.a,{container:!0},r.a.createElement(Qt.a,{xsDown:!0},r.a.createElement(T.a,{item:!0,sm:1,md:2})),r.a.createElement(T.a,{item:!0,xs:12,sm:10,md:8},r.a.createElement(U.a,null,r.a.createElement(N.a,{variant:"h4",component:"h1",style:{fontWeight:500}},"@",a.getPublicProfile.username),r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement("span",{style:{fontWeight:500}},"Name: "),a.getPublicProfile.name||"anonymous"),r.a.createElement(N.a,{paragraph:!0},r.a.createElement("span",{style:{fontWeight:500}},"About:")," ",a.getPublicProfile.about||"No about section yet."),r.a.createElement(pt,{images:a.getPublicProfile.images}))),r.a.createElement(Qt.a,{xsDown:!0},r.a.createElement(T.a,{item:!0,sm:1,md:2}))),r.a.createElement(N.a,{component:"h2",style:{fontWeight:500,fontSize:"1.5rem"},align:"center",paragraph:!0},"@",a.getPublicProfile.username," 's Posts:"),r.a.createElement(T.a,{container:!0,spacing:4},u&&Array.from({length:8}).map((function(e,t){return r.a.createElement(qt.a,{in:u,timeout:250,key:t},r.a.createElement(T.a,{item:!0,xs:4},r.a.createElement(Ee,null)))})),!u&&!m&&l&&l.listPostsByUser.map((function(e){return r.a.createElement(qt.a,{in:!u&&!m&&!!l,timeout:750,key:e._id},r.a.createElement(T.a,{item:!0,xs:12,sm:6,md:4},r.a.createElement(fe,{post:e})))}))))},zt=a(298),Mt=a.n(zt),$t=a(310),Gt=function(){var e=Object(P.i)().id,t=Object(s.useQuery)(pe,{variables:{id:e}}),a=t.data,n=t.error;return t.loading?"loading":n?n.message:a&&r.a.createElement(T.a,{container:!0,justify:"center"},r.a.createElement(T.a,{item:!0,xs:11,sm:9,md:8},r.a.createElement($t.a,{style:{padding:"4rem 3rem"},elevation:3},r.a.createElement(N.a,{variant:"h4",component:"h1",style:{fontWeight:500},paragraph:!0,align:"center"},a.getPost.title),r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"2rem"}},r.a.createElement(W.a,{src:a.getPost.postedBy.images[0].url,style:{marginRight:"0.5rem",width:25,height:25}}),r.a.createElement(N.a,{variant:"body2",style:{margin:0}},"@",a.getPost.postedBy.username),r.a.createElement("span",{style:{margin:"0 0.5rem"}},"-"),r.a.createElement(N.a,{variant:"body2",style:{margin:0}},new Date(a.getPost.createdAt).toLocaleDateString())),r.a.createElement(B.a,{src:a.getPost.image.url,height:200,style:{height:200,width:"80%",objectFit:"cover",display:"block",borderRadius:10,margin:"0 auto 2rem"}}),r.a.createElement("div",null,Mt()(a.getPost.content)))))},Kt=function(e){return Lt(),r.a.createElement(P.b,e)},Yt=function(e){var t=e.component,a=Object(At.a)(e,["component"]),o=Object(n.useContext)(O).state.user;return Lt(),localStorage.getItem("AUTH_TOKEN")||o?r.a.createElement(P.a,{to:"/dashboard/profile"}):r.a.createElement(P.b,Object.assign({},a,{component:t}))},Jt=a(580),Vt=a(582),Zt=a(309),Xt=a(595),ea=a(303),ta=a.n(ea),aa=a(307),na=a.n(aa),ra=a(305),oa=a.n(ra),ca=a(306),ia=a.n(ca),la=a(304),sa=a.n(la),ua=a(299),ma=a(301),pa=a(4),da=new s.HttpLink({uri:"".concat("http://localhost:8000","/graphql")}),ba=new ua.a({uri:"".concat("ws://localhost:8000","/graphql"),options:{reconnect:!0}}),fa=Object(s.split)((function(e){var t=e.query,a=Object(pa.p)(t);return"OperationDefinition"===a.kind&&"subscription"===a.operation}),ba,da),ga=Object(ma.a)((function(e,t){var a=t.headers,n=localStorage.getItem("AUTH_TOKEN");return{headers:Object(f.a)(Object(f.a)({},a),{},{authorization:n?"Bearer ".concat(n):""})}})),Ea=new s.ApolloLink((function(e,t){if(e.variables){e.variables=JSON.parse(JSON.stringify(e.variables),(function(e,t){return"__typename"===e?void 0:t}))}return t(e).map((function(e){return e}))})),ha=new s.ApolloClient({link:s.ApolloLink.from([Ea,ga,fa]),cache:new s.InMemoryCache}),ya=a(589),va=function(){var e=Oa(),t=Object(P.g)(),a=Object(s.useLazyQuery)(be),o=Object(b.a)(a,2),c=o[0],i=o[1].data,l=Object(n.useState)(!1),u=Object(b.a)(l,2),m=u[0],g=u[1],E=Object(n.useState)(""),h=Object(b.a)(E,2),y=h[0],v=h[1],O=Object(n.useState)(!1),j=Object(b.a)(O,2),x=j[0],w=j[1],S=Object(n.useState)([]),k=Object(b.a)(S,2),R=k[0],C=k[1];return Object(n.useEffect)((function(){x||C([])}),[x]),Object(n.useEffect)((function(){return m&&(clearTimeout(Ye),Ye=setTimeout((function(){g(!1)}),750)),function(){Ye&&clearTimeout(Ye)}}),[m]),Object(n.useEffect)((function(){Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y&&(g(!0),c({variables:{term:y}}));case 1:case"end":return e.stop()}}),e)})))()}),[y,c]),Object(n.useEffect)((function(){i&&C(i.searchPosts)}),[i]),r.a.createElement(ya.a,{id:"search-bar",style:{width:250},open:x,onOpen:function(){w(!0)},onClose:function(){w(!1)},getOptionSelected:function(e){t.push("/posts/".concat(e._id))},getOptionLabel:function(e){return e.title},options:R,loading:m,renderInput:function(t){return r.a.createElement(ke.a,Object.assign({},t,{className:e.input,label:"Search...",variant:"standard",value:y,onChange:function(e){return v(e.target.value)},InputProps:Object(f.a)(Object(f.a)({},t.InputProps),{},{endAdornment:r.a.createElement(n.Fragment,null,m?r.a.createElement(Ce.a,{style:{color:"#fff"},size:20}):null,t.InputProps.endAdornment),style:{borderBottom:"1px solid white",color:"#fff"}})}))}})},Oa=Object(Qe.a)((function(e){return{input:{marginTop:"-1.25rem","& .MuiFormLabel-root":{color:"#fff"},"& .MuiSvgIcon-root":{fill:"#fff"},"& .MuiInputLabel-shrink":{transform:"translate(0, 7px) scale(0.75)"}}}})),ja=function(){var e=xa(),t=r.a.useState(null),a=Object(b.a)(t,2),o=a[0],c=a[1],i=Object(n.useContext)(O),l=i.state,s=i.dispatch,m=Object(P.g)(),f=Object(P.h)(),g=function(){c(null)},h=function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.signOut();case 3:return g(),localStorage.removeItem("AUTH_TOKEN"),e.next=7,ha.resetStore();case 7:s({type:"USER_LOGGED_OUT"}),m.push("/login"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("LOGOUT ERROR",e.t0),s({type:"AUTH_ERROR"});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:e.root},r.a.createElement(Jt.a,{position:"fixed"},r.a.createElement(k.a,null,r.a.createElement(Vt.a,{className:e.toolBar},r.a.createElement(Qt.a,{smUp:!0},r.a.createElement(H.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(ta.a,null))),r.a.createElement(N.a,{component:u.b,to:"/",variant:"h6",className:e.title,style:{marginRight:l.user?"0.5rem":"auto"}},r.a.createElement(sa.a,{style:{fontSize:32,marginRight:5}}),"Realtime Blog"),l.user&&r.a.createElement(Re.a,{component:u.b,to:"/dashboard/create",color:"inherit",style:{marginLeft:"1rem",marginRight:"auto"}},r.a.createElement(oa.a,{style:{marginRight:1}}),r.a.createElement("span",{style:{marginTop:3}},"New Post")),"/"===f.pathname&&r.a.createElement(va,null),r.a.createElement(H.a,{component:u.b,to:"/users",style:{color:"#fff",marginLeft:"0.25rem"}},r.a.createElement(ia.a,null)),l.user?r.a.createElement("div",null,r.a.createElement(H.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit",edge:"end"},r.a.createElement(na.a,null)),r.a.createElement(Zt.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!o,onClose:g},r.a.createElement(Xt.a,{component:u.b,onClick:g,to:"/dashboard/profile"},"Dashboard"),r.a.createElement(Xt.a,{onClick:h},"Logout"))):r.a.createElement(n.Fragment,null,r.a.createElement(Re.a,{component:u.b,to:"/login",color:"inherit"},"Login"),r.a.createElement(Re.a,{component:u.b,to:"/register",color:"inherit"},"Register"))))),r.a.createElement(Vt.a,null))},xa=Object(Qe.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{color:"inherit",textDecoration:"none",display:"flex",alignItems:"center"},toolBar:{padding:0}}})),wa=a(583),Pa=function(e){var t=e.user;return r.a.createElement(D.a,{elevation:3},r.a.createElement(_.a,{avatar:r.a.createElement(W.a,{src:t.images[0].url}),title:"@".concat(t.username),subheader:t.name||"anonymous"}),r.a.createElement(wa.a,null),r.a.createElement(q.a,{style:{minHeight:105}},r.a.createElement(N.a,null,r.a.createElement("span",{style:{fontWeight:500}},"About:")," ",t.about&&t.about.length>100?"".concat(t.about.slice(0,100),"..."):t.about&&t.about.length<=100?t.about:"No about section yet.")),r.a.createElement(F.a,{disableSpacing:!0},r.a.createElement(Re.a,{component:u.b,to:"/users/".concat(t.username),color:"primary",style:{marginLeft:"auto"}},"Profile")))},Sa=function(){return r.a.createElement(D.a,{elevation:3},r.a.createElement(_.a,{avatar:r.a.createElement(ge.a,{variant:"circle",width:40,height:40}),title:r.a.createElement(ge.a,{width:"40%"}),subheader:r.a.createElement(ge.a,{width:"30%"})}),r.a.createElement(wa.a,null),r.a.createElement(q.a,{style:{minHeight:100}},r.a.createElement(ge.a,{style:{height:18,width:"100%",marginBottom:4}}),r.a.createElement(ge.a,{style:{height:18,width:"100%",marginBottom:4}}),r.a.createElement(ge.a,{style:{height:18,width:"80%"}})),r.a.createElement(F.a,null,r.a.createElement(ge.a,{width:"20%",style:{height:"2.5rem",marginLeft:"auto"}})))},ka=function(){var e=Object(s.useQuery)(Ve),t=e.loading,a=e.error,o=e.data;return a?r.a.createElement("p",null,a.message):r.a.createElement(n.Fragment,null,r.a.createElement(T.a,{container:!0,spacing:4},t&&Array.from({length:8}).map((function(e,a){return r.a.createElement(qt.a,{in:t,timeout:250,key:a},r.a.createElement(T.a,{item:!0,xs:4},r.a.createElement(Sa,null)))})),!t&&!a&&o&&o.listUsers.map((function(e){return r.a.createElement(qt.a,{in:!t&&!a&&!!o,timeout:750,key:e._id},r.a.createElement(T.a,{item:!0,xs:12,sm:6,md:4},r.a.createElement(Pa,{user:e})))}))))},Ra={hidden:{opacity:0,y:-50},visible:{opacity:1,y:0},exit:{opacity:0}},Ca=function(){var e=Object(n.useContext)(x),t=e.state.post,a=e.setState,o=Object(n.useContext)(O).state.user,c=Object(s.useMutation)(re),i=Object(b.a)(c,1)[0],l=Object(n.useState)(null===t||void 0===t?void 0:t.title),u=Object(b.a)(l,2),m=u[0],f=u[1],g=Object(n.useState)(null===t||void 0===t?void 0:t.content),E=Object(b.a)(g,2),h=E[0],y=E[1],v=Object(n.useState)(!1),j=Object(b.a)(v,2),w=j[0],P=j[1],k=Object(n.useState)(null===t||void 0===t?void 0:t.tags),R=Object(b.a)(k,2),T=R[0],U=R[1],I=Object(n.useState)(null),A=Object(b.a)(I,2),D=A[0],L=A[1];Object(n.useEffect)((function(){t&&(f(t.title),y(t.content),U(t.tags))}),[t]);var _=function(){var e=Object(d.a)(p.a.mark((function e(){var n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P(!0),e.prev=1,!D){e.next=14;break}return e.t0=et.a,e.t1="".concat("http://localhost:8000","/api/v1/images/posts"),e.next=7,nt(D);case 7:return e.t2=e.sent,e.t3={image:e.t2},e.t4={headers:{authorization:"Bearer ".concat(null===o||void 0===o?void 0:o.token)}},e.next=12,e.t0.post.call(e.t0,e.t1,e.t3,e.t4);case 12:r=e.sent,n=r.data.data.image;case 14:return c={id:t._id,title:m,content:h,tags:T},n&&(c.image=n),e.next=18,i({variables:{input:c}});case 18:S.b.success("".concat(t.title," is successfully updated.")),a({post:null}),e.next=26;break;case 22:e.prev=22,e.t5=e.catch(1),console.error("[UPDATE POST ERROR]",e.t5),S.b.error(e.t5.message);case 26:P(!1);case 27:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Ot,{disabled:!(m&&h),loading:w,open:!!t,confirmButtonText:w?r.a.createElement(Ce.a,{size:24}):"Update",title:"Update Post",handleClose:function(){return a({post:!1})},handleConfirm:_},r.a.createElement(C.a,null,t&&r.a.createElement(C.b.div,{variants:Ra,initial:"hidden",animate:"visible",exit:"exit"},r.a.createElement(ke.a,{id:"create-post-title",label:"Give your post a title",fullWidth:!0,value:m,onChange:function(e){return f(e.target.value)},inputProps:{type:"text"},style:{marginBottom:"1rem"},disabled:w}),r.a.createElement(Pt.a,{defaultValue:T,fullWidth:!0,label:"Add post tags",placeholder:"Type and press enter to add tags",style:{marginBottom:"1rem"},onChange:U}),t.image&&r.a.createElement(B.a,{width:200,height:100,duration:1e3,src:t.image.url,alt:t.title,style:{display:"block",width:200,height:100,objectFit:"cover",borderRadius:10,marginBottom:"1rem"}}),r.a.createElement(Ut,{handleFiles:function(e){return L(e.length?e[0]:null)},isUpdate:!0}),r.a.createElement(Tt,{content:h,setContent:y}))))},Ta=(a(520),function(){return r.a.createElement(n.Fragment,null,r.a.createElement(ja,null),r.a.createElement(k.a,{style:{paddingTop:"2rem"}},r.a.createElement(P.d,null,r.a.createElement(Yt,{exact:!0,path:"/register",component:Te}),r.a.createElement(Yt,{exact:!0,path:"/complete-register",component:_e}),r.a.createElement(Yt,{exact:!0,path:"/login",component:We}),r.a.createElement(Yt,{exact:!0,path:"/password-forget",component:Ne}),r.a.createElement(Kt,{exact:!0,path:"/users",component:ka}),r.a.createElement(Kt,{exact:!0,path:"/users/:username",component:Ht}),r.a.createElement(_t,{exact:!0,path:"/dashboard/:subroute",component:Nt}),r.a.createElement(Kt,{exact:!0,path:"/posts/:id",component:Gt}),r.a.createElement(Kt,{exact:!0,path:"/",component:Se}))),r.a.createElement(S.a,{bodyStyle:{fontFamily:"'Rubik', sans-serif"}}),r.a.createElement(Ca,null))}),Ua=a(308),Ia=Object(Ua.a)({typography:{fontFamily:"'Rubik', sans-serif"},palette:{primary:{main:"#3d0e5b"},secondary:{main:"#d11692"},background:{default:"#fcfcfc"}}});c.a.render(r.a.createElement(u.a,null,r.a.createElement(s.ApolloProvider,{client:ha},r.a.createElement(j,null,r.a.createElement(w,null,r.a.createElement(i.a,{theme:Ia},r.a.createElement(l.a,null),r.a.createElement(Ta,null)))))),document.getElementById("root"))}},[[327,1,2]]]);
//# sourceMappingURL=main.51a87b3c.chunk.js.map